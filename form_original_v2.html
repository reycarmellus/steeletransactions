<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>Steele Transactions Request Form</title>
<style>

  body { font-family: system-ui, Arial, sans-serif; padding: 20px; }
  h1 { margin-top: 0; }
  .form-section { border: 1px solid #ddd; padding: 16px; border-radius: 8px; margin-bottom: 16px; }
  .section-desc { color: #555; font-size: 0.95rem; margin-top: -8px; }
  fieldset { border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px; }
  legend { font-weight: 600; }
  label { display: block; margin-top: 8px; }
  input[type="text"], input[type="email"], input[type="tel"], input[type="number"], input[type="date"], select, textarea {
    width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px;
  }
  .repeater-item { border: 1px dashed #aaa; padding: 12px; border-radius: 6px; margin: 8px 0; }
  .btn { padding: 8px 12px; border: 1px solid #999; background: #f5f5f5; border-radius: 4px; cursor: pointer; }
  .btn.remove { margin-left: 8px; }
  .submit-bar { position: sticky; bottom: 0; background: #fff; padding: 12px 0; border-top: 1px solid #eee; }
  .hidden { display: none !important; }
  .note { color: #666; font-size: 0.9rem; }


  /* Custom modal */
  .rt-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.45); display: none; align-items: center; justify-content: center; z-index: 9999; }
  .rt-modal { width: min(520px, 92%); background: #fff; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.25); overflow: hidden; }
  .rt-modal header { padding: 14px 16px; border-bottom: 1px solid #eee; font-weight: 600; font-size: 1.05rem; }
  .rt-modal .rt-body { padding: 16px; font-size: 0.98rem; color: #222; }
  .rt-modal footer { padding: 12px 16px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 8px; }
  .rt-btn { padding: 8px 12px; border: 1px solid #999; background: #f5f5f5; border-radius: 6px; cursor: pointer; }
  .rt-btn:focus { outline: 2px solid #4c9ffe; outline-offset: 2px; }

</style>
</head>
<body>
<h1>Steele Transactions Request Form</h1>
<form autocapitalize="off" autocomplete="off" data-survey-id="SRV001" id="intakeForm" novalidate="" spellcheck="false">
<section class="form-section" data-section="S001" data-survey-id="SRV001" id="SRV001_S001" style="display:block">
<h2>Service Request &amp; Agent Info</h2>
<!--<p class="section-desc">Type of Service Request & Requestor Info</p> -->
<div class="question" data-qid="Q001"><label for="serviceSelection">Please select service:</label>
<select id="serviceSelection" name="serviceSelection" required="">
<option value="">--Select--</option>
<option value="Offer Writing">Offer Writing</option>
<option value="Listing Preparation">Listing Preparation</option>
<option value="MLS Input Only">MLS Input Only</option>
</select></div>
<div class="question" data-qid="Q002"><label for="requestorName">Agent Name:</label>
<input id="requestorName" name="requestorName" required="" type="text"/>
</div>
<div class="question" data-qid="Q003"><label for="requestorEmail">Agent Email Address:</label>
<input id="requestorEmail" name="requestorEmail" placeholder="e.g. name@example.com" required="" type="email"/>
</div>
</section>
<section class="form-section" data-section="S002" data-survey-id="SRV001" id="SRV001_S002" style="display:none">
<h2>Offer Writing - Buyer's Rep</h2>
<!--<p class="section-desc">Buyer's Rep</p>-->
<div class="question" data-qid="Q004"><fieldset>
<legend>Do you need me to prepare a Buyers Rep?</legend>
<label><input name="buyersRep" required="" type="radio" value="Yes"/> Yes</label><br/>
<label><input name="buyersRep" type="radio" value="No"/> No</label>
</fieldset></div>
</section>
<section class="form-section" data-section="S003" data-survey-id="SRV001" id="SRV001_S003" style="display:none">
<h2>Offer Writing - Buyer's Rep Details</h2>
<!--<p class="section-desc">Buyer's Rep Details</p>-->
<div class="question" data-qid="Q005"><fieldset id="buyersInfo">
<legend>Buyer(s) Information</legend>
<div class="buyer-entry">
<label for="buyerName1">Name:</label>
<input id="buyerName1" name="buyerName[]" required="" type="text"/>
<label for="buyerEmail1">Email Address:</label>
<input id="buyerEmail1" name="buyerEmail[]" required="" type="email"/>
<label for="buyerPhone1">Phone Number:</label>
<input id="buyerPhone1" name="buyerPhone[]" required="" type="tel"/>
</div>
<button onclick="addBuyer()" type="button">+ Add Another Buyer</button>
</fieldset>
</div>
<div class="question" data-qid="Q006"><fieldset>
<legend>What is the Start and End Date of your Buyers Rep?</legend>
<label for="buyersRepStart">Start Date:</label>
<input id="buyersRepStart" name="buyersRepStart" type="date"/>
<label for="buyersRepEnd">End Date:</label>
<input id="buyersRepEnd" name="buyersRepEnd" type="date"/>
</fieldset>
</div>
<div class="question" data-qid="Q007">
<label for="buyersAgentCommission">What is your BAC? (Buyer's Agent Commission):</label>
<input id="buyersAgentCommission" name="buyersAgentCommission" placeholder="ex. 3" title="Enter commission as a percentage or flat amount" type="text"/>
</div>
<div class="question" data-qid="Q008"><!-- Section: Additional Notes -->
<fieldset>
<legend>Additional Information</legend>
<!--<label for="remarks">Any other notes or remarks?</label><br/>-->
<textarea cols="50" name="remarks" placeholder="Type your comments here..." rows="4"></textarea><br/><br/>
</fieldset>
</div>
</section>
<section class="form-section" data-section="S004" data-survey-id="SRV001" id="SRV001_S004" style="display:none">
<h2>Offer Writing - Property Address and Financing</h2>
<!--<p class="section-desc">Property Address and Financing</p>-->
<div class="question" data-qid="Q009"><fieldset>
<legend>What is the Property Address?</legend>
<label for="streetAddress">Street Address:</label>
<input id="streetAddress" name="streetAddress" required="" type="text"/>
<label for="city">City:</label>
<input id="city" name="city" required="" type="text"/>
<label for="state">State:</label>
<input id="state" name="state" readonly="" type="text" value="TX"/>
<label for="zipCode">Zip Code:</label>
<input id="zipCode" name="zipCode" pattern="\d{5}" required="" title="Enter a 5-digit ZIP code" type="text"/>
</fieldset>
</div>
<div class="question" data-qid="Q010"><label for="financingType">What type of Financing?</label>
<select id="financingType" name="financingType" onchange="toggleOtherFinancing()">
<option value="">--Select--</option>
<option value="Cash">Cash</option>
<option value="FHA">FHA</option>
<option value="Conventional">Conventional</option>
<option value="VA">VA</option>
<option value="USDA">USDA</option>
<option value="Other">Other</option>
</select>
<div id="otherFinancingContainer" style="display:none; margin-top:8px;">
<label for="otherFinancing">Please specify:</label>
<input id="otherFinancing" name="otherFinancing" type="text"/>
</div>
</div>
</section>
<section class="form-section" data-section="S005" data-survey-id="SRV001" id="SRV001_S005" style="display:none">
<h2>Offer Writing - Third Party Financing</h2>
<!--<p class="section-desc">Third Party Financing</p>-->
<div class="question" data-qid="Q015"><label for="salesPrice">What is the Sales Price?</label>
<input id="salesPrice" min="0" name="salesPrice" placeholder="e.g. 250000" step="0.01" type="number"/>
</div>
<div class="question" data-qid="Q011"><fieldset>
<legend>What is the Down Payment &amp; Total Sales Price?</legend>
<label for="downPayment">Down Payment:</label>
<input id="downPayment" min="0" name="downPayment" placeholder="e.g. 20000" step="0.01" type="number"/>
<label for="salesPrice">Total Sales Price:</label>
<input id="salesPrice" min="0" name="salesPrice" placeholder="e.g. 250000" step="0.01" type="number"/>
</fieldset>
</div>
<div class="question" data-qid="Q012"><fieldset>
<legend>Interest not to exceed:</legend>
<label><input name="interestCap" required="" type="radio" value="1%"/> 1%</label><br/>
<label><input name="interestCap" type="radio" value="2%"/> 2%</label><br/>
<label><input name="interestCap" type="radio" value="N/A"/> N/A</label>
</fieldset>
</div>
<div class="question" data-qid="Q013"><fieldset>
<legend>Due in how many years?</legend>
<label><input name="loanTerm" onclick="toggleOtherTerm()" type="radio" value="15 years"/> 15 years</label><br/>
<label><input name="loanTerm" onclick="toggleOtherTerm()" type="radio" value="30 years"/> 30 years</label><br/>
<label><input name="loanTerm" onclick="toggleOtherTerm()" type="radio" value="Other"/> Other</label>
<div id="otherTermContainer" style="display:none; margin-top:8px;">
<label for="otherTerm">Please specify number of years:</label>
<input id="otherTerm" min="1" name="otherTerm" placeholder="e.g. 20" type="number"/>
</div>
</fieldset>
</div>
<div class="question" data-qid="Q014"><fieldset>
<legend>How many days for Buyer to obtain Financing Approval?</legend>
<label><input name="financingApprovalDays" onclick="toggleFinancingOther()" type="radio" value="21"/> 21 days</label><br/>
<label><input name="financingApprovalDays" onclick="toggleFinancingOther()" type="radio" value="30"/> 30 days</label><br/>
<label><input name="financingApprovalDays" onclick="toggleFinancingOther()" type="radio" value="Other"/> Other</label>
<div id="financingOtherContainer" style="display:none; margin-top:8px;">
<label for="financingOther">Please specify number of days:</label>
<input id="financingOther" min="1" name="financingOther" placeholder="e.g. 45" type="number"/>
</div>
</fieldset>
</div>
</section>
<section class="form-section" data-section="S006" data-survey-id="SRV001" id="SRV001_S006" style="display:none">
<h2>Offer Writing - Offer Information</h2>
<!--<p class="section-desc">Offer Information</p>-->
<div class="question" data-qid="Q016"><label for="titleCompany">Title Company Preference:</label>
<input id="titleCompany" name="titleCompany" placeholder="e.g. ABC Title Services" type="text"/>
</div>
<div class="question" data-qid="Q017"><fieldset>
<legend>Financial Terms</legend>
<label for="earnestMoney">Earnest Money:</label>
<input id="earnestMoney" name="earnestMoney" required="" type="number"/><br/>
<label for="optionMoney">Option Money:</label>
<input id="optionMoney" name="optionMoney" required="" type="number"/><br/>
<label for="optionDays">Number of Option Days:</label>
<input id="optionDays" name="optionDays" required="" type="number"/>
</fieldset>
</div>
<div class="question" data-qid="Q018">
<fieldset>
<legend>Who pays the Title Policy?</legend>
<label>
<input name="titlePolicyPayer" type="checkbox" value="Buyer"/> Buyer
    </label><br/>
<label>
<input name="titlePolicyPayer" type="checkbox" value="Seller"/> Seller
    </label>
</fieldset>
</div>
<div class="question" data-qid="Q019">
<fieldset>
<legend>If no Survey is provided, who pays for a new one?</legend>
<label>
<input name="surveyResponsibility" type="checkbox" value="Buyer"/> Buyer
    </label><br/>
<label>
<input name="surveyResponsibility" type="checkbox" value="Seller"/> Seller
    </label><br/>
<label>
<input name="surveyResponsibility" type="checkbox" value="BuyersExpense"/> Amend Survey Shortages @ Buyers Expense
    </label><br/>
<label>
<input name="surveyResponsibility" type="checkbox" value="SellersExpense"/> Amend Survey Shortages @ Sellers Expense
    </label><br/>
<label>
<input name="surveyResponsibility" type="checkbox" value="NoAmend"/> No Amend Survey Shortages
    </label>
</fieldset>
</div>
<div class="question" data-qid="Q020"><label for="titlePolicyObjections">Does Buyer have Objections to the Title Policy?</label>
<textarea id="titlePolicyObjections" name="titlePolicyObjections" placeholder="Enter any objections or concerns here..." rows="4"></textarea>
</div>
<div class="question" data-qid="Q021"><label for="hoaStatus">Is the property in a Mandatory HOA?</label>
<select id="hoaStatus" name="hoaStatus" required="">
<option value="">--Select--</option>
<option value="Yes">Yes</option>
<option value="No">No</option>
<option value="Voluntary">Voluntary</option>
</select>
</div>
</section>
<section class="form-section" data-section="S007" data-survey-id="SRV001" id="SRV001_S007" style="display:none">
<h2>Offer Writing - HOA Details</h2>
<!--<p class="section-desc">HOA Details</p>-->
<div class="question" data-qid="Q022"><label for="hoaInfoDays">Within how many days do you want the HOA info supplied?</label>
<input id="hoaInfoDays" min="1" name="hoaInfoDays" placeholder="e.g. 5" type="number"/>
</div>
<div class="question" data-qid="Q023"><label for="buyerFees">Up to what amount is Buyer willing to pay towards fees &amp; deposits?</label>
<input id="buyerFees" min="0" name="buyerFees" placeholder="e.g. 1500" step="0.01" type="number"/>
</div>
<div class="question" data-qid="Q024"><fieldset>
<legend style="font-weight: normal;">Who pays for obtaining additional information if Title requires it?</legend>
<label><input name="infoPayer" required="" type="radio" value="Buyer"/> Buyer</label><br/>
<label><input name="infoPayer" type="radio" value="Seller"/> Seller</label>
</fieldset></div>
</section>
<section class="form-section" data-section="S008" data-survey-id="SRV001" id="SRV001_S008" style="display:none">
<h2>Offer Writing - Offer Information</h2>
<!--<p class="section-desc">Offer Information</p>-->
<div class="question" data-qid="Q025"><label for="buyerCondition">Buyer accepts property "AS IS" or is it subject to repairs?</label>
<textarea id="buyerCondition" name="buyerCondition" required="" rows="4"></textarea>
</div>
<div class="question" data-qid="Q026"><label for="homeWarrantyAmount">Home Warranty Amount:</label>
<input id="homeWarrantyAmount" min="0" name="homeWarrantyAmount" placeholder="e.g. 500" step="0.01" type="number"/>
</div>
<div class="question" data-qid="Q027"><label for="closingDate">Closing Date:</label>
<input id="closingDate" name="closingDate" required="" type="date"/></div>
<div class="question" data-qid="Q028"><fieldset>
<legend>Is there a Leaseback?</legend>
<label><input name="leaseback" onclick="toggleLeasebackDetails()" type="radio" value="Yes"/> Yes</label><br/>
<label><input name="leaseback" onclick="toggleLeasebackDetails()" type="radio" value="No"/> No</label>
<!--<div id="leasebackDetailsContainer" style="display:none; margin-top:8px;">
<label for="leasebackDetails">If yes, provide details below:</label>
<textarea id="leasebackDetails" name="leasebackDetails" placeholder="e.g. Seller to lease back for 30 days post-closing at $X/day" rows="4"></textarea>
</div>-->
<div id="leasebackTypeContainer" style="display:none; margin-top:8px;"><label>Leaseback Type:</label><br/><label><input name="leasebackType" type="radio" value="Buyers Temp Lease"/> Buyers Temp Lease</label><br/><label><input name="leasebackType" type="radio" value="Sellers Temp Lease"/> Sellers Temp Lease</label></div><div id="leasebackAdditionalInfoContainer" style="display:none; margin-top:8px;"><label for="leasebackAdditionalInfo">Leaseback - Additional Information:</label><textarea id="leasebackAdditionalInfo" name="leasebackAdditionalInfo" placeholder="Any extra notes about the leaseback" rows="3"></textarea></div>
</fieldset>
</div>
<div class="question" data-qid="Q029"><label for="sellerConcessions">Any Seller Concessions?</label>
<textarea id="sellerConcessions" name="sellerConcessions" placeholder="e.g. Seller to contribute $5,000 toward closing costs or repairs..." rows="4"></textarea>
</div>
<div class="question" data-qid="Q030"><fieldset>
<legend>Are you requesting the Seller to pay BAC?</legend>
<label><input name="sellerPaysBAC" required="" type="radio" value="Yes"/> Yes</label><br/>
<label><input name="sellerPaysBAC" type="radio" value="No"/> No</label>
</fieldset>
</div>
</section>
<section class="form-section" data-section="S009" data-survey-id="SRV001" id="SRV001_S009" style="display:none">
<h2>Offer Writing - Commission</h2>
<!--<p class="section-desc">Commission</p>-->
<div class="question" data-qid="Q031"><label for="sellerBACAmount">How much are you requesting the Seller to pay BAC?</label>
<input id="sellerBACAmount" min="0" name="sellerBACAmount" placeholder="e.g. 3000" step="0.01" type="number"/>
</div>
</section>
<section class="form-section" data-section="S010" data-survey-id="SRV001" id="SRV001_S010" style="display:none">
<h2>Offer Writing - Commission</h2>
<!--<p class="section-desc">Commission</p>-->
<div class="question" data-qid="Q032"><label for="listingBrokerBAC">How much are you requesting the Listing Broker to pay towards BAC?</label>
<small>(Compensation Agreement between Brokers will be included)</small>
<input id="listingBrokerBAC" min="0" name="listingBrokerBAC" placeholder="e.g. 1500" step="0.01" type="number"/>
<!--<small>(Compensation Agreement between Brokers will be included)</small>-->
</div>
</section>
<section class="form-section" data-section="S011" data-survey-id="SRV001" id="SRV001_S011" style="display:none">
<h2>Listing Preparation - Listing Information</h2>
<!--<p class="section-desc">Listing Preparation</p>-->
<div class="question" data-qid="Q033"><label for="listingAgreementStatus">Have I prepared a Listing Agreement for you before?</label>
<select id="listingAgreementStatus" name="listingAgreementStatus">
<option value="">--Select an option--</option>
<option value="Yes">Yes</option>
<option value="No">No</option>
<option value="Yes - but I want to change some information">Yes – but I want to change some information (such as the # of days in Protection Period)</option>
</select></div>
<div class="question" data-qid="Q034"><fieldset id="sellersInfo">
<legend>Please provide your Seller(s) contact information:</legend>
<p>(If not already in your Zipforms, Docusign, Skyslope…etc)</p>
<div class="seller-entry">
<label for="sellerName1">Legal Name:</label>
<input id="sellerName1" name="sellerName[]" required="" type="text"/>
<label for="sellerEmail1">Email Address:</label>
<input id="sellerEmail1" name="sellerEmail[]" required="" type="email"/>
<label for="sellerPhone1">Phone Number:</label>
<input id="sellerPhone1" name="sellerPhone[]" required="" type="tel"/>
</div>
<button onclick="addSeller()" type="button">+ Add Another Seller</button>
</fieldset>
</div>
<div class="question" data-qid="Q035"><fieldset>
<legend>What is the Property Address?</legend>
<label for="streetAddress">Street Address:</label>
<input id="streetAddress" name="streetAddress" required="" type="text"/>
<label for="city">City:</label>
<input id="city" name="city" required="" type="text"/>
<label for="state">State:</label>
<input id="state" name="state" readonly="" type="text" value="TX"/>
<label for="zipCode">Zip Code:</label>
<input id="zipCode" name="zipCode" pattern="\d{5}" required="" title="Enter a 5-digit ZIP code" type="text"/>
</fieldset>
</div>
<div class="question" data-qid="Q036"><label for="listPrice">What is the List Price?</label>
<input id="listPrice" min="0" name="listPrice" placeholder="e.g. 350000" step="0.01" type="number"/>
</div>
<div class="question" data-qid="Q037"><fieldset>
<legend style="font-weight: normal;">What is the Start and End Date of your Listing Agreement?</legend>
<label for="listingStartDate">Start Date:</label>
<input id="listingStartDate" name="listingStartDate" type="date"/>
<label for="listingEndDate">End Date:</label>
<input id="listingEndDate" name="listingEndDate" type="date"/>
</fieldset>
</div>
<div class="question" data-qid="Q038"><fieldset>
<legend style="font-weight: normal;">What is the commission &amp; is there any BAC commission being offered?</legend>
<label for="totalCommission">Total Commission (% or $):</label>
<input id="totalCommission" min="0" name="totalCommission" placeholder="e.g. 6" step="0.01" type="number"/>
<label for="bacCommission">BAC Commission Offered (% or $):</label>
<input id="bacCommission" min="0" name="bacCommission" placeholder="e.g. 3" step="0.01" type="number"/>
</fieldset>
</div>
<div class="question" data-qid="Q039"><label for="photoDate">What date have photos been scheduled for?</label>
<small>(Or forward me the photos if already completed)</small>
<input id="photoDate" name="photoDate" type="date"/>
</div>
<div class="question" data-qid="Q040"><label for="liveDate">What is your anticipated Live Date?</label>
<input id="liveDate" name="liveDate" type="date"/>
</div>
</section>
<section class="form-section" data-section="S012" data-survey-id="SRV001" id="SRV001_S012" style="display:none">
<h2>Listing Preparation - Listing Agreement</h2>
<!--<p class="section-desc">Listing Agreement</p>-->
<div class="question" data-qid="Q041"><label for="mandatoryHOA">Is the property in a Mandatory HOA?</label>
<select id="mandatoryHOA" name="mandatoryHOA" required="">
<option value="">--Select an option--</option>
<option value="Yes">Yes</option>
<option value="No">No</option>
<option value="Voluntary">Voluntary</option>
</select>
</div>
<div class="question" data-qid="Q042"><label for="protectionPeriod">Number of days in Protection Period:</label>
<input id="protectionPeriod" min="1" name="protectionPeriod" placeholder="e.g. 90" type="number"/>
</div>
<div class="question" data-qid="Q043"><label for="brokerCounty">In what County are amounts payable to the Broker?</label>
<input id="brokerCounty" name="brokerCounty" placeholder="e.g. Travis County" required="" type="text"/>
</div>
<div class="question" data-qid="Q044"><label for="preferredTitleCompany">Who is your preferred Title Company?</label>
<input id="preferredTitleCompany" name="preferredTitleCompany" placeholder="Enter company name or type N/A" required="" type="text"/>
</div>
<div class="question" data-qid="Q045"><fieldset>
<legend style="font-weight: normal;">Is there an existing Survey on file?</legend>
<label><input name="surveyOnFile" required="" type="radio" value="Yes"/> Yes</label><br/>
<label><input name="surveyOnFile" type="radio" value="No"/> No</label><br/>
<label><input name="surveyOnFile" type="radio" value="Unsure"/> Unsure</label>
</fieldset>
</div>
<div class="question" data-qid="Q046"><fieldset>
<legend style="font-weight: normal;">Is the Onsite Sewer Addendum (OSS) needed?</legend>
<label><input name="ossNeeded" required="" type="radio" value="Yes"/> Yes</label><br/>
<label><input name="ossNeeded" type="radio" value="No"/> No</label><br/>
<label><input name="ossNeeded" type="radio" value="Unsure"/> Unsure</label>
</fieldset>
</div>
<div class="question" data-qid="Q047"><label for="nearbySchools">Are there Elementary, Middle &amp; High School nearby?</label>
<input id="nearbySchools" name="nearbySchools" placeholder="e.g. Elm Creek Elementary" required="" type="text"/>
</div>
</section>
<section class="form-section" data-section="S013" data-survey-id="SRV001" id="SRV001_S013" style="display:none">
<h2>Listing Preparation - Additional Information</h2>
<!--<p class="section-desc">Additional Information</p>-->
<div class="question" data-qid="Q048"><label for="propertyFeatures">Any property features you want highlighted?</label>
<textarea id="propertyFeatures" name="propertyFeatures" placeholder="e.g. Newly renovated kitchen, spacious backyard, energy-efficient windows..." rows="4"></textarea></div>
<div class="question" data-qid="Q049"><label for="listingNotes">Notes/Additional Information pertaining to your listing:</label>
<textarea id="listingNotes" name="listingNotes" placeholder="e.g. Seller prefers weekend showings, property includes solar panels, recent roof replacement..." rows="4"></textarea>
</div>
</section>
<section class="form-section" data-section="S014" data-survey-id="SRV001" id="SRV001_S014" style="display:none">
<h2>MLS Input Only</h2>
<!--<p class="section-desc">MLS Input Only</p>-->
<div class="question" data-qid="Q050"><fieldset>
<legend>Which MLS(s) would you like the property uploaded to?</legend>
<label><input name="mlsOptions[]" type="checkbox" value="GTAR"/> GTAR</label><br/>
<label><input name="mlsOptions[]" type="checkbox" value="LAAR"/> LAAR</label><br/>
<label><input name="mlsOptions[]" type="checkbox" value="NETREIS"/> NETREIS</label><br/>
<label><input name="mlsOptions[]" type="checkbox" value="HAR"/> HAR</label>
</fieldset>
</div>
<div class="question" data-qid="Q051"><fieldset>
<legend>What is the Property Address?</legend>
<label for="streetAddress">Street Address:</label>
<input id="streetAddress" name="streetAddress" required="" type="text"/>
<label for="city">City:</label>
<input id="city" name="city" required="" type="text"/>
<label for="state">State:</label>
<input id="state" name="state" readonly="" type="text" value="TX"/>
<label for="zipCode">Zip Code:</label>
<input id="zipCode" name="zipCode" pattern="\d{5}" required="" title="Enter a 5-digit ZIP code" type="text"/>
</fieldset>
</div>
<div class="question" data-qid="Q052"><label for="listPrice">What is the List Price?</label>
<input id="listPrice" min="0" name="listPrice" placeholder="e.g. 350000" step="0.01" type="number"/>
</div>
<div class="question" data-qid="Q053"><label for="listingEndDate">What is the Listing End Date?</label>
<small>(It is the Agent's responsibility to input the Start Date)</small>
<input id="listingEndDate" name="listingEndDate" required="" type="date"/>
</div>
<div class="question" data-qid="Q054"><label for="preferredTitleCompany">Who is your preferred Title Company?</label>
<input id="preferredTitleCompany" name="preferredTitleCompany" placeholder="Enter company name or type N/A" required="" type="text"/>
<!--<small>(Required for NETREIS &amp; HAR or type N/A)</small>-->
</div>
<div class="question" data-qid="Q055"><fieldset>
<legend style="font-weight: normal;">Can you provide the Room Dimensions for the Bedrooms, Kitchen, Living Room &amp; Dining Room?</legend>
<p>(Required for NETREIS &amp; HAR listings or type N/A)</p>
<label for="bedroomDimensions">Bedrooms:</label>
<input id="bedroomDimensions" name="bedroomDimensions" placeholder="e.g. 12ft x 14ft or N/A" required="" type="text"/>
<label for="kitchenDimensions">Kitchen:</label>
<input id="kitchenDimensions" name="kitchenDimensions" placeholder="e.g. 10ft x 12ft or N/A" required="" type="text"/>
<label for="livingRoomDimensions">Living Room:</label>
<input id="livingRoomDimensions" name="livingRoomDimensions" placeholder="e.g. 15ft x 20ft or N/A" required="" type="text"/>
<label for="diningRoomDimensions">Dining Room:</label>
<input id="diningRoomDimensions" name="diningRoomDimensions" placeholder="e.g. 10ft x 10ft or N/A" required="" type="text"/>
</fieldset>
</div>
<div class="question" data-qid="Q056"><label for="photoDate">What date have photos been scheduled for?</label>
<input id="photoDate" name="photoDate" type="date"/>
<small>(Or forward me the photos if already completed)</small>
</div>
<div class="question" data-qid="Q057"><label for="liveDate">What is your anticipated Live Date?</label>
<input id="liveDate" name="liveDate" type="date"/>
</div>
<div class="question" data-qid="Q058"><label for="propertyFeatures">Any property features you want highlighted?</label>
<textarea id="propertyFeatures" name="propertyFeatures" placeholder="e.g. Newly renovated kitchen, spacious backyard, energy-efficient windows..." rows="4"></textarea></div>
<div class="question" data-qid="Q059"><label for="associatedDocs">
  If the property is already listed, I will download a copy of all Associated Docs.<br/>
  Otherwise, please send me a copy of anything that needs to be uploaded:<br/>
<small>(Survey, Seller’s Disclosure, LBP, Onsite Sewer…etc)</small>
</label>
<textarea id="associatedDocs" name="associatedDocs" placeholder="List documents or type N/A if already uploaded" required="" rows="4"></textarea>
</div>
</section>
<section class="form-section" data-section="S015" data-survey-id="SRV001" id="SRV001_S015" style="display:none">
<h2>Additional documents and Privacy Policy</h2>
<!--<p class="section-desc">Additional documents and Privacy Policy</p>-->
<div class="question" data-qid="Q060"><label for="propertyNotes">Notes/Additional Information pertaining to this Offer:</label>
<textarea id="propertyNotes" name="propertyNotes" placeholder="e.g. Non-Realty Items Addendum, Inspector Information, etc..." rows="4"></textarea>
</div>
<div class="question" data-qid="Q061"><label for="associatedDocuments">Any Associated Documents:</label>
<input id="associatedDocuments" multiple="" name="associatedDocuments[]" required="" type="file"/></div>
<div class="question" data-qid="Q062"><fieldset>
<legend>
    By submitting this form, you confirm that you have authorization to share your client's contact information with Steele Transactions for the purpose of preparing an offer.  
    <br/>
    Our <a href="https://steeletransactions.com/wp-content/uploads/2023/05/Steele-Transactions-Privacy-Policy-1.pdf" target="_blank">Privacy Policy</a> can be accessed here.
  </legend>
<label><input name="authorizationConfirmed" required="" type="radio" value="Yes"/> Yes</label><br/>
<label><input name="authorizationConfirmed" type="radio" value="No"/> No</label>
</fieldset></div>
</section>
<div class="submit-bar">
<button class="btn" type="submit">Submit</button>
<span class="note" id="status"></span>
</div>
</form>
<script>
const BRANCH = {
  "start": "SRV001_S001",
  "surveyId": "SRV001",
  "sections": {
    "SRV001_S001": {
      "title": "Request Type",
      "question": "Q001",
      "branches": {
        "Offer Writing": "SRV001_S002",
        "Listing Preparation": "SRV001_S011",
        "MLS Input Only": "SRV001_S014"
      }
    },
    "SRV001_S002": {
      "title": "Offer Writing - Buyer Rep",
      "question": "Q004",
      "branches": {
        "Yes": "SRV001_S003",
        "No": "SRV001_S004"
      }
    },
    "SRV001_S003": {
      "title": "Offer Writing - Buyer Rep Details",
      "next": "SRV001_S004"
    },
    "SRV001_S004": {
      "title": "Offer Writing - Property Address and Financing",
      "question": "Q010",
      "branches": {
        "Cash": "SRV001_S006",
        "FHA": "SRV001_S005",
        "Conventional": "SRV001_S005",
        "VA": "SRV001_S005",
        "USDA": "SRV001_S005",
        "Other": "SRV001_S005"
      }
    },
    "SRV001_S005": {
      "title": "Offer Writing - Third Party Financing",
      "next": "SRV001_S006"
    },
    "SRV001_S006": {
      "title": "Offer Writing - Offer Information",
      "question": "Q021",
      "branches": {
        "Yes": "SRV001_S007",
        "No": "SRV001_S008",
        "Voluntary": "SRV001_S008"
      }
    },
    "SRV001_S007": {
      "title": "Offer Writing - HOA Details",
      "next": "SRV001_S008"
    },
    "SRV001_S008": {
      "title": "Offer Writing - Offer Information",
      "question": "Q030",
      "branches": {
        "Yes": "SRV001_S009",
        "No": "SRV001_S010"
      }
    },
    "SRV001_S009": {
      "title": "Offer Writing - Commission",
      "next": "SRV001_S015"
    },
    "SRV001_S010": {
      "title": "Offer Writing - Commission",
      "next": "SRV001_S015"
    },
    "SRV001_S011": {
      "title": "Listing Preparation - Listing Information",
      "question": "Q033",
      "branches": {
        "Yes": [
          "SRV001_S013",
          "SRV001_S015"
        ],
        "No": [
          "SRV001_S012"
        ],
        "Yes but I want to change some information (such as the # of days in Protection Period)": [
          "SRV001_S012"
        ],
        "Yes - but I want to change some information": [
          "SRV001_S012"
        ]
      }
    },
    "SRV001_S012": {
      "title": "Listing Preparation - Listing Agreement",
      "next": [
        "SRV001_S013",
        "SRV001_S015"
      ]
    },
    "SRV001_S013": {
      "title": "Listing Preparation - Seller and Property",
      "next": "SRV001_S015"
    },
    "SRV001_S014": {
      "title": "MLS Input Only",
      "next": "SRV001_S015"
    },
    "SRV001_S015": {
      "title": "Additional documents and Privacy Policy"
    }
  }
};
const Q_TO_FIELD = {"Q001": "serviceSelection", "Q002": "requestorName", "Q003": "requestorEmail", "Q004": "buyersRep", "Q006": "buyersRepStart", "Q007": "buyersAgentCommission", "Q008": "remarks", "Q009": "streetAddress", "Q010": "financingType", "Q011": "downPayment", "Q012": "interestCap", "Q013": "loanTerm", "Q014": "financingApprovalDays", "Q015": "salesPrice", "Q016": "titleCompany", "Q017": "earnestMoney", "Q018": "titlePolicyPayer", "Q019": "surveyResponsibility", "Q020": "titlePolicyObjections", "Q021": "hoaStatus", "Q022": "hoaInfoDays", "Q023": "buyerFees", "Q024": "infoPayer", "Q025": "buyerCondition", "Q026": "homeWarrantyAmount", "Q027": "closingDate", "Q028": "leaseback", "Q029": "sellerConcessions", "Q030": "sellerPaysBAC", "Q031": "sellerBACAmount", "Q032": "listingBrokerBAC", "Q033": "listingAgreementStatus", "Q035": "streetAddress", "Q036": "listPrice", "Q037": "listingStartDate", "Q038": "totalCommission", "Q039": "photoDate", "Q040": "liveDate", "Q041": "mandatoryHOA", "Q042": "protectionPeriod", "Q043": "brokerCounty", "Q044": "preferredTitleCompany", "Q045": "surveyOnFile", "Q046": "ossNeeded", "Q047": "nearbySchools", "Q048": "propertyFeatures", "Q049": "listingNotes", "Q051": "streetAddress", "Q052": "listPrice", "Q053": "listingEndDate", "Q054": "preferredTitleCompany", "Q055": "bedroomDimensions", "Q056": "photoDate", "Q057": "liveDate", "Q058": "propertyFeatures", "Q059": "associatedDocs", "Q060": "propertyNotes", "Q062": "authorizationConfirmed"};

function norm(v) { return String(v || '').toLowerCase().replace(/[–—-]/g,' ').replace(/\s+/g,' ').trim(); }


function getAnswerByField(field) {
  if (!field) return '';
  const nodes = document.getElementsByName(field);
  if (!nodes || !nodes.length) return '';
  const first = nodes[0];
  if (first.type === 'radio') {
    const checked = document.querySelector('[name="' + field + '"]:checked');
    return checked ? (checked.value || '') : '';
  }
  if (first.type === 'checkbox') {
    const checked = Array.from(document.querySelectorAll('[name="' + field + '"]:checked')).map(c => c.value);
    return checked.length ? checked.join(',') : '';
  }
  if (first.tagName === 'SELECT') {
    return first.value || '';
  }
  return first.value || '';
}


function nextFromSection(domId) {
  const sec = BRANCH.sections[domId];
  if (!sec) return [];
  if (sec.question) {
    const field = Q_TO_FIELD[sec.question];
    const ans = getAnswerByField(field);
    if (!ans) return [];
    if (sec.branches) {
      for (const [k,v] of Object.entries(sec.branches)) {
        if (norm(ans) === norm(k)) return Array.isArray(v) ? v : [v];
      }
      return [];
    }
  }
  if (sec.next) return Array.isArray(sec.next) ? sec.next : [sec.next];
  return [];
}

// reveal only the next unanswered section
function computeVisibleIncremental() {
  const visible = new Set([BRANCH.start]);
  const queue = [BRANCH.start];
  const visited = new Set();
  let steps = 0;
  while (queue.length && steps++ < 200) {
    const sid = queue.shift();
    if (visited.has(sid)) continue;
    visited.add(sid);
    const nextIds = nextFromSection(sid);
    for (const nid of nextIds) {
      if (!nid) continue;
      visible.add(nid);
      const nsec = BRANCH.sections[nid];
      if (nsec && nsec.question) {
        const field = Q_TO_FIELD[nsec.question];
        const ans = getAnswerByField(field);
        if (ans) queue.push(nid); // only continue past answered sections
      } else {
        queue.push(nid); // sections without a question always flow
      }
    }
  }
  return visible;
}

function applyVisibility() {
  const visible = computeVisibleIncremental();
  Object.keys(BRANCH.sections).forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.style.display = visible.has(id) ? 'block' : 'none';
  });
  document.querySelectorAll('.form-section').forEach(section => {
    const hidden = getComputedStyle(section).display === 'none';
    section.querySelectorAll('input,select,textarea').forEach(inp => {
      if (hidden) { inp.dataset.wasRequired = inp.required ? '1' : '0'; inp.required = false; }
      else if (inp.dataset.wasRequired === '1' || inp.hasAttribute('required')) { inp.required = true; }
    });
  });
}

document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('intakeForm');
  const names = new Set(Object.values(Q_TO_FIELD));
  ['change','input'].forEach(evt => form.addEventListener(evt, function(e) {
    if (e && e.target && names.has(e.target.name)) applyVisibility();
  }));
  const svc = document.getElementById('serviceSelection') || document.querySelector('[name="serviceSelection"]');
  if (svc) svc.addEventListener('change', applyVisibility);

  // ----- Submit to Google Apps Script -----
  const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbytZaO0ar50PrqgK8TDY0UVH5nQZrC2VvsLnN7uWRapxMlBpEQNpFwuPRsVgE7fHDbeVw/exec';

  function collectData(form) {
    const fd = new FormData();
    const data = {};
    form.querySelectorAll('input, select, textarea').forEach(el => {
      if (el.type === 'file') return;
      if (!el.name) return;
      if (el.type === 'radio') {
        if (!el.checked) return;
        data[el.name] = el.value;
      } else if (el.name.endsWith('[]')) {
        if (!data[el.name]) data[el.name] = [];
        if (el.value) data[el.name].push(el.value);
      } else {
        data[el.name] = el.value;
      }
    });
    form.querySelectorAll('input[type="file"]').forEach(inp => {
      for (let i=0;i<inp.files.length;i++) fd.append(inp.name || 'file', inp.files[i]);
    });
    fd.append('data', JSON.stringify(data));
    return fd;
  }

  //form.addEventListener('submit', async function(e) {
  //  e.preventDefault();
  //  const status = document.getElementById('status');
  //  status.textContent = 'Sending...';
  //  try {
  //    const payload = collectData(form);
  //    const res = await fetch(GAS_ENDPOINT, { method: 'POST', body: payload, mode: 'cors' });
  //    const json = await res.json();
  //    if (json.success) {
  //      status.textContent = 'Submitted. Reference ID: ' + json.respondentId;
  //      form.reset();
        // Reset repeaters if present
  //      const buyers = document.getElementById('buyersList'); if (buyers) buyers.innerHTML='';
  //      const sellers = document.getElementById('sellersList'); if (sellers) sellers.innerHTML='';
  //      applyVisibility();
  //    } else {
  //      status.textContent = 'Error: ' + (json.message || 'Unknown error');
  //    }
  //  } catch (err) {
  //    console.error(err);
  //    status.textContent = 'Error sending form';
  //  }
  //});

  applyVisibility();
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const form = document.getElementById('intakeForm');
  if (!form) return;

  // Force all fields to ignore stored suggestions
  form.querySelectorAll('input, select, textarea').forEach(el => {
    el.setAttribute('autocomplete', 'off');
    el.setAttribute('autocapitalize', 'off');
    el.setAttribute('spellcheck', 'false');
  });

  // If the page was restored from backforward cache, clear any old values
  window.addEventListener('pageshow', function (e) {
    if (e.persisted) {
      form.reset();
      if (typeof applyVisibility === 'function') applyVisibility();
      window.scrollTo(0, 0);
    }
  });
});
</script>
<script>
const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbytZaO0ar50PrqgK8TDY0UVH5nQZrC2VvsLnN7uWRapxMlBpEQNpFwuPRsVgE7fHDbeVw/exec';

document.addEventListener('DOMContentLoaded', function () {
  const form = document.querySelector('form');
  if (!form) return;

  function fileToBase64(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result.split(',')[1]);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  }

  function collectPlainData(formEl) {
    const out = {};
    const fd = new FormData(formEl);
    for (const [k, v] of fd.entries()) {
      if (v instanceof File) continue;
      if (k.endsWith('[]')) {
        const key = k.slice(0, -2);
        if (!Array.isArray(out[key])) out[key] = [];
        out[key].push(v);
      } else if (out[k] !== undefined) {
        if (!Array.isArray(out[k])) out[k] = [out[k]];
        out[k].push(v);
      } else {
        out[k] = v;
      }
    }
    return out;
  }

  async function collectAttachments(formEl) {
    const list = [];
    const inputs = formEl.querySelectorAll('input[type="file"]');
    for (const input of inputs) {
      if (!input.files || !input.files.length) continue;
      for (const f of input.files) {
        list.push({
          fileName: f.name,
          mimeType: f.type || 'application/octet-stream',
          fileData: await fileToBase64(f)
        });
      }
    }
    return list;
  }

  function statusEl() {
    let el = document.getElementById('status');
    if (!el) {
      el = document.createElement('p');
      el.id = 'status';
      el.style.marginTop = '8px';
      form.appendChild(el);
    }
    return el;
  }

  form.addEventListener('submit', async function (e) {
    e.preventDefault();
    const status = statusEl();
    status.textContent = 'Sending';

    try {
      const data = collectPlainData(form);
      const attachments = await collectAttachments(form);

      const res = await fetch(GAS_ENDPOINT, {
        method: 'POST',
        body: JSON.stringify({ data, attachments })
      });

      const text = await res.text();
      let json;
      try { json = JSON.parse(text); } catch { json = { success:false, message:text }; }

if (json.success || json.ok) {
  // Hide any status text beside the button
  status.textContent = '';
  status.style.display = 'none';

  // Friendly confirmation
  showRequestModal('Request Submitted', 'Thank you. We will reach out to you within 48 hours. We appreciate your business.');

  // Full reset
  form.reset();

  // Remove any extra dynamic entries that may have been added
  const buyersInfo = document.getElementById('buyersInfo');
  if (buyersInfo) {
    const buyerRows = buyersInfo.querySelectorAll('.buyer-entry');
    buyerRows.forEach((row, idx) => { if (idx > 0) row.remove(); });
  }
  const sellersInfo = document.getElementById('sellersInfo');
  if (sellersInfo) {
    const sellerRows = sellersInfo.querySelectorAll('.seller-entry');
    sellerRows.forEach((row, idx) => { if (idx > 0) row.remove(); });
  }

  // Recompute visibility so only the first section shows
  if (typeof applyVisibility === 'function') applyVisibility();

  // Back to the very top and focus the first field
  window.scrollTo({ top: 0, behavior: 'smooth' });
  const firstField = document.getElementById('serviceSelection') || form.querySelector('input,select,textarea');
  if (firstField) firstField.focus({ preventScroll: true });

  return; // done
}
 else {
        status.textContent = 'Error: ' + (json.message || json.error || 'Unknown error');
      }
    } catch (err) {
      status.textContent = 'Error: ' + err.message;
    }
  });
});
</script>
<!-- Request Submitted Modal -->
<div aria-describedby="rtModalDesc" aria-labelledby="rtModalTitle" aria-modal="true" class="rt-modal-overlay" id="rtModalOverlay" role="dialog">
<div class="rt-modal">
<header id="rtModalTitle">Request Submitted</header>
<div class="rt-body" id="rtModalDesc">Thank you. We will reach out to you within 48 hours. We appreciate your business.</div>
<footer>
<button class="rt-btn" id="rtModalOk" type="button">OK</button>
</footer>
</div>
</div>
<script>
// ===== Repeater helpers for Buyers and Sellers =====
(function() {
  function createInput(labelText, baseName, type, idSuffix) {
    const wrap = document.createElement('div');
    wrap.className = 'field-wrap';
    const label = document.createElement('label');
    const id = baseName + idSuffix;
    label.setAttribute('for', id);
    label.textContent = labelText;
    const input = document.createElement('input');
    input.type = type || 'text';
    input.id = id;
    input.name = baseName.endsWith('[]') ? baseName : baseName + '[]';
    input.required = true;
    wrap.appendChild(label);
    wrap.appendChild(input);
    return wrap;
  }

  function addBuyer() {
    const fieldset = document.getElementById('buyersInfo');
    if (!fieldset) return;
    const count = fieldset.querySelectorAll('.buyer-entry').length + 1;
    const entry = document.createElement('div');
    entry.className = 'buyer-entry repeater-item';

    entry.appendChild(createInput('Name:', 'buyerName', 'text', String(count)));
    entry.appendChild(createInput('Email Address:', 'buyerEmail', 'email', String(count)));
    entry.appendChild(createInput('Phone Number:', 'buyerPhone', 'tel', String(count)));

    const btnRow = document.createElement('div');
    btnRow.style.marginTop = '8px';

    const addBtn = document.createElement('button');
    addBtn.type = 'button';
    addBtn.className = 'btn';
    addBtn.textContent = '+ Add';
    addBtn.addEventListener('click', addBuyer);

    const remBtn = document.createElement('button');
    remBtn.type = 'button';
    remBtn.className = 'btn remove';
    remBtn.textContent = 'Remove';
    remBtn.addEventListener('click', function() {
      removeEntry(entry, 'buyersInfo', '.buyer-entry');
    });

    btnRow.appendChild(addBtn);
    btnRow.appendChild(remBtn);
    entry.appendChild(btnRow);

    fieldset.appendChild(entry);
  }
  window.addBuyer = addBuyer;

  function addSeller() {
    const fieldset = document.getElementById('sellersInfo');
    if (!fieldset) return;
    const count = fieldset.querySelectorAll('.seller-entry').length + 1;
    const entry = document.createElement('div');
    entry.className = 'seller-entry repeater-item';

    entry.appendChild(createInput('Legal Name:', 'sellerName', 'text', String(count)));
    entry.appendChild(createInput('Email Address:', 'sellerEmail', 'email', String(count)));
    entry.appendChild(createInput('Phone Number:', 'sellerPhone', 'tel', String(count)));

    const btnRow = document.createElement('div');
    btnRow.style.marginTop = '8px';

    const addBtn = document.createElement('button');
    addBtn.type = 'button';
    addBtn.className = 'btn';
    addBtn.textContent = '+ Add';
    addBtn.addEventListener('click', addSeller);

    const remBtn = document.createElement('button');
    remBtn.type = 'button';
    remBtn.className = 'btn remove';
    remBtn.textContent = 'Remove';
    remBtn.addEventListener('click', function() {
      removeEntry(entry, 'sellersInfo', '.seller-entry');
    });

    btnRow.appendChild(addBtn);
    btnRow.appendChild(remBtn);
    entry.appendChild(btnRow);

    fieldset.appendChild(entry);
  }
  window.addSeller = addSeller;

  function removeEntry(entryEl, parentId, selector) {
    const parent = document.getElementById(parentId);
    if (!parent) return;
    const items = parent.querySelectorAll(selector);
    if (items.length <= 1) {
      // Keep at least one item visible
      const inputs = items[0].querySelectorAll('input');
      inputs.forEach(i => i.value = '');
      return;
    }
    entryEl.remove();
  }
  window.removeEntry = removeEntry;
})();

// ===== Simple modal to avoid browser alert title showing the origin =====
(function() {
  const overlay = document.getElementById('rtModalOverlay');
  const okBtn = document.getElementById('rtModalOk');
  function showRequestModal(title, message) {
    const titleEl = document.getElementById('rtModalTitle');
    const bodyEl  = document.getElementById('rtModalDesc');
    if (titleEl) titleEl.textContent = title || 'Request Submitted';
    if (bodyEl)  bodyEl.textContent  = message || '';
    if (overlay) overlay.style.display = 'flex';
    // trap focus
    if (okBtn) okBtn.focus();
  }
  function hideModal() {
    if (overlay) overlay.style.display = 'none';
  }
  if (okBtn) okBtn.addEventListener('click', hideModal);
  if (overlay) overlay.addEventListener('click', function(e) {
    if (e.target === overlay) hideModal();
  });
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') hideModal();
  });
  // expose
  window.showRequestModal = showRequestModal;
})();
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const financingSel = document.getElementById('financingType');
  const s004 = document.getElementById('SRV001_S004');
  const s005 = document.getElementById('SRV001_S005');
  if (!financingSel || !s004 || !s005) return;

  // Find the Q015 block inside S005 and remember its original spot
  const q015InS005 = s005.querySelector('[data-qid="Q015"]');
  if (!q015InS005) return;
  const q015Anchor = document.createComment('Q015 original spot');
  q015InS005.parentNode.insertBefore(q015Anchor, q015InS005);

  // Create a placeholder in S004 right after Q010
  const q010Block = s004.querySelector('[data-qid="Q010"]');
  const s004Holder = document.createElement('div');
  s004Holder.id = 'cashSalesPriceHolder';
  if (q010Block && q010Block.nextSibling) {
    q010Block.parentNode.insertBefore(s004Holder, q010Block.nextSibling);
  } else if (q010Block) {
    q010Block.parentNode.appendChild(s004Holder);
  } else {
    s004.appendChild(s004Holder);
  }

  function relocateSalesPrice() {
    const val = (financingSel.value || '').trim();
    // When Cash move Q015 under Q010
    if (val === 'Cash') {
      if (!s004Holder.contains(q015InS005)) {
        s004Holder.appendChild(q015InS005);
        // Make sure the moved block is visible with the section
        q015InS005.style.display = 'block';
      }
    } else {
      // Return Q015 to its original location in S005
      if (q015InS005.parentNode !== s005) {
        q015Anchor.parentNode.insertBefore(q015InS005, q015Anchor.nextSibling);
      }
    }
  }

  financingSel.addEventListener('change', relocateSalesPrice);
  relocateSalesPrice();
});
</script>
<script>
function toggleLeasebackDetails() {
  const yes = document.querySelector('input[name="leaseback"][value="Yes"]');
  const typeBox = document.getElementById('leasebackTypeContainer');
  const detailsBox = document.getElementById('leasebackDetailsContainer');
  const addlBox = document.getElementById('leasebackAdditionalInfoContainer');
  const show = yes && yes.checked;
  if (typeBox) typeBox.style.display = show ? 'block' : 'none';
  if (detailsBox) detailsBox.style.display = show ? 'block' : 'none';
  if (addlBox) addlBox.style.display = show ? 'block' : 'none';
  if (!show) {
    // clear values when hidden
    const radios = document.querySelectorAll('input[name="leasebackType"]');
    radios.forEach(r => r.checked = false);
    const details = document.getElementById('leasebackDetails');
    if (details) details.value = '';
    const more = document.getElementById('leasebackAdditionalInfo');
    if (more) more.value = '';
  }
}
// run once on load to sync state
document.addEventListener('DOMContentLoaded', toggleLeasebackDetails);
</script>
<!-- Injected rules: skip S013 on specific condition; dynamic privacy policy and Q060 placeholder -->
<script>
(function(){
  function norm(v){ return String(v||'').toLowerCase().replace(/[–—-]/g,' ').replace(/\s+/g,' ').trim(); }
  function getAns(name){
    const nodes = document.getElementsByName(name);
    if(!nodes || !nodes.length) return '';
    const first = nodes[0];
    if (first.type === 'radio') {
      const checked = document.querySelector('[name="'+name+'"]:checked');
      return checked ? checked.value : '';
    }
    if (first.tagName === 'SELECT') return first.value || '';
    return first.value || '';
  }

  // 1. If Q001 = Listing Preparation and Q033 = No then skip S013 else keep everything
  function hideS013IfNeeded(){
    try{
      const svc = getAns('serviceSelection');          // Q001
      const q033 = getAns('listingAgreementStatus');   // Q033
      const s013 = document.getElementById('SRV001_S013');
      if (!s013) return;
      const shouldSkip = norm(svc) === 'listing preparation' && norm(q033) === 'no';
      if (shouldSkip) {
        s013.style.display = 'none';
        s013.querySelectorAll('input,select,textarea').forEach(inp => { inp.dataset.wasRequired = inp.required ? '1' : '0'; inp.required = false; });
      }
    }catch(e){}
  }

  // 2. Dynamic Privacy Policy text and Q060 placeholder based on Q001
  function updatePolicyAndQ060(){
    try{
      const svc = getAns('serviceSelection'); // Q001
      const legend = document.querySelector('[data-qid="Q062"] legend');
      const linkHtml = 'Our <a href="https://steeletransactions.com/wp-content/uploads/2023/05/Steele-Transactions-Privacy-Policy-1.pdf" target="_blank">Privacy Policy</a> can be accessed here.';

      if (legend) {
        if (norm(svc) === 'listing preparation') {
          legend.innerHTML = "By submitting this form, you confirm that you have authorization to share your client\\'s contact information with Steele Transactions for the purpose of preparing a property listing.<br/>" + linkHtml;
        } else if (norm(svc) === 'mls input only') {
          legend.innerHTML = "By submitting this form, you confirm that you have authorization to share your client\\'s contact information with Steele Transactions for the purpose of inputting a listing into the MLS.<br/>" + linkHtml;
        } else if (norm(svc) === 'offer writing') {
          legend.innerHTML = "By submitting this form, you confirm that you have authorization to share your client\\'s contact information with Steele Transactions for the purpose of preparing an offer.<br/>" + linkHtml;
        }
      }

      const q060 = document.getElementById('propertyNotes'); // Q060
      if (q060) {
        if (norm(svc) === 'listing preparation') {
          q060.setAttribute('placeholder','e.g. # of Bed/Baths, Features you want highlighted, etc...');
        } else if (norm(svc) === 'mls input only') {
          q060.setAttribute('placeholder','');
        }
      }
    }catch(e){}
  }

  // Hook into the existing visibility flow
  const originalApply = window.applyVisibility;
  if (typeof originalApply === 'function') {
    window.applyVisibility = function(){
      originalApply();
      hideS013IfNeeded();
      updatePolicyAndQ060();
    };
  }

  document.addEventListener('DOMContentLoaded', function(){
    const form = document.getElementById('intakeForm');
    if (!form) return;

    form.addEventListener('change', function(e){
      if (e && e.target && (e.target.name === 'serviceSelection' || e.target.name === 'listingAgreementStatus')) {
        if (typeof window.applyVisibility === 'function') window.applyVisibility();
      }
    });

    // Run once at load
    if (typeof window.applyVisibility === 'function') window.applyVisibility();
    else { hideS013IfNeeded(); updatePolicyAndQ060(); }
  });
})();
</script>

</body>
</html>
